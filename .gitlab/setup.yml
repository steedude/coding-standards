variables:
  NODE_VERSION: '20'
  PNPM_VERSION: '9'
  CACHE_KEY: '${CI_PROJECT_PATH_SLUG}-${CI_COMMIT_REF_SLUG}'

image: node:${NODE_VERSION}-alpine

cache:
  key: ${CACHE_KEY}
  paths:
    - .pnpm-store
    - node_modules/
  policy: pull-push

before_script:
  - corepack enable
  - corepack prepare pnpm@${PNPM_VERSION} --activate
  - pnpm config set store-dir .pnpm-store
  - pnpm install
